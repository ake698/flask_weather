<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}首页{% endblock %} </title>

    <!-- Bootstrap -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/assets/bootstrap-daterangepicker/daterangepicker.css">
    <link rel="stylesheet" href="/static/assets/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/static/css/common.css">
    <link rel="stylesheet" href="/static/css/main.css">
  {% block heads %} {% endblock %}
{#    <link rel="stylesheet" href="/static/css/bootstrap-select.min.css">#}

  </head>
  <body>
  <!-- 头 -->
  <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <span class="navbar-sidebar-toggle" data-toggle="tooltip" data-placement="right" title="菜单栏收缩或展开"><i class="fa fa-bars" style="margin-top: 12px;" aria-hidden="true"></i></span>
        <a class="navbar-brand" href="#">后台管理</a>
      </div>

        <div class="dropdown" style="float: right;margin-right: 20px">
          <button class="btn btn-default dropdown-toggle" type="button" id="navbar-dropdownmenu" data-toggle="dropdown">
            <img src="/static/images/avatar-mini.jpg" id="author_img" width="35" height="35" alt="个人头像">
            <span id="username">uuuuuuu</span>
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="navbar-dropdownmenu">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="setting" class="setting">设置</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="/logout/">退出登录</a></li>
          </ul>
        </div>
      </div>
    </div>
  </nav>

<!--上导航技术-->
  <div class="wrapper">
    <aside class="sidebar-menu">
      <div class="separator-50"></div>

      <ul class="menu-list">
        <li class="menu-item {% block activeindex %} {% endblock %} ">
          <a href="/user/index/"><i class="fa fa-home" aria-hidden="true"></i>首页</a>
        </li>
        <li class="separator-20"></li>





        <li class="menu-item {% block activeuser %} {% endblock %} ">
          <a href="#"><i class="fa fa-user" aria-hidden="true"></i>个人信息</a>
          <ul class="sub-menu-list">
            <li class="sub-menu-item"><a href="/user/userinfo/">详细信息</a></li>
            <li class="sub-menu-item"><a href="/user/userchange/">修改信息</a></li>
            <li class="sub-menu-item"><a href="#"  class="setting">修改密码</a></li>
          </ul>
        </li>

      <li class="menu-item {% block activemessage %} {% endblock %} ">
          <a href="#"><i class="fa fa-cube" aria-hidden="true"></i>留言管理</a>
            <ul class="sub-menu-list">
                    <li class="sub-menu-item"><a href="/user/message/">我的留言</a></li>
                  </ul>

        </li>
        <li class="menu-item">
          <a href="javascript:void(0)"><i class="fa fa-adn" aria-hidden="true"></i>更多页面</a>
          <ul class="sub-menu-list">
            <li class="sub-menu-item"><a href="/">返回站点</a></li>
          </ul>
        </li>


        <li class="separator-30"></li>

        <li class="menu-item">
          <a href="/logout/"><i class="fa fa-sign-out" aria-hidden="true"></i>安全退出</a>
        </li>

      </ul>
    </aside>


    <div class="main-container">
      <div class="padding">
        <ol class="breadcrumb">
          {% block ol %} 当前选项 {% endblock %}
        </ol>
        <div class="box">
      {% block content %}
          内容
      {% endblock %}
        </div>
      </div>
    </div>


    <footer class="main-footer">
      <p>后台管理系统</p>
    </footer>
  </div>

  <!--密码模块-->
  <div class="modal fade" id="adminModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="adminModalLabel2">个人密码修改</h4>
        </div>
        <div class="modal-body">
          <form class="form-horizontal">

            <div class="form-group">
              <label  class="col-sm-2 control-label">旧密码</label>
              <div class="col-sm-10">
                <input type="password" name="oldpassword" class="form-control" id="password">
                <span class="help-block"></span>
              </div>
            </div>

            <div class="form-group">
              <label  class="col-sm-2 control-label">新密码</label>
              <div class="col-sm-10">
                <input type="password" name="password" class="form-control" id="newpassword" >
                <span class="help-block"></span>
              </div>
            </div>

            <div class="form-group">
              <label  class="col-sm-2 control-label">重复密码</label>
              <div class="col-sm-10">
                <input type="password" name="newpassword" class="form-control" id="newpassword2">
                <span class="help-block"></span>
              </div>
            </div>

          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
          <button type="button" class="btn btn-primary" id="admin_modal_btn">确定</button>
        </div>
      </div>
    </div>
  </div>


  <div class="scroll-to-top"><i class="fa fa-chevron-up fa-lg"></i></div>

  <script src="/static/assets/jquery/jquery-3.1.1.min.js"></script>
  <script src="/static/assets/bootstrap/js/bootstrap.min.js"></script>
  <script src="/static/assets/bootstrap-daterangepicker/moment.min.js"></script>
  <script src="/static/assets/bootstrap-daterangepicker/daterangepicker.js"></script>
  <script src="/static/js/main.js"></script>
{#  <script src="/static/js/bootstrap-select.min.js"></script>#}

  <script>

function getCookie(cookieName) {
    var cookieValue = "";
    if (document.cookie && document.cookie != '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = cookies[i];
            console.log(cookie);
            cookiesp = cookie.split("=");
            console.log(cookiesp);
            if(cookiesp[0].trim()==cookieName.trim()){
                console.log(cookiesp[1]);
                cookieValue = cookiesp[1];
            }
        }
    }
    return cookieValue;
}


      function formReset(ele) {
          $(ele+" form").each(function () {
              this.reset();
          })
      }
{##}
{#      //清除表单样式#}
{#      function formClassReset(ele){#}
{#          $(ele).find("*").removeClass("has-error has-success");#}
{#          $(ele).find(".help-block").text("");#}
{#      }#}

      //提示信息
{#      function show_msg(ele,msg) {#}
{#          msg=msg||"此选项为必填！！";#}
{#          var temp = $(ele).val();#}
{#          if(temp=="" || temp==undefined){#}
{#              $(ele).parent().parent().addClass("has-error");#}
{#              $(ele).next("span").text(msg);#}
{#              console.log(ele);#}
{#              return false;#}
{#          }else{#}
{#              $(ele).parent().parent().addClass("has-success");#}
{#              return true;#}
{#          }#}
{#      }#}

{#      function validate_data_form(ele){#}
{#          formClassReset(ele);  //清除样式#}
{#          flag = true;#}
{#          console.log(ele);#}
{#          $(ele + " form input").each(function () {#}
{#              if(!show_msg(this)){#}
{#                  flag = false;#}
{#              }#}
{#          });#}
{#          return flag;#}
{#      }#}


      $(".setting").click(function () {
          formReset("#adminModal");
{#          formClassReset("#adminModal");#}
          $("#adminModal").modal()
      });

      //确定按钮点击
    $("#admin_modal_btn").click(function () {

        if(!($("#newpassword").val()==$("#newpassword2").val())){
            alert("俩次密码输入不一致！！");
            return;
        }
        password = $("#password").val();
        newpassword = $("#newpassword").val();
        if(newpassword.length<6||newpassword.length>18){
            alert("密码长度必须大于6小于18");
            return;
        }

        $.ajax({
            url:"/user/userpwd/",
            type:"POST",
            data:{"password":password,"newpassword":newpassword},
            success:function (data) {
                if(data.code==400){
                    alert(data.detail);
                    formClassReset("#adminModal")
                }else{
                    alert("修改成功！");
                    formReset("#adminModal");
                    $("#adminModal").modal("hide");
                }
            }
        })

    })
  </script>
  {% block scriptblock %}

  {% endblock %}
  </body>
</html>
